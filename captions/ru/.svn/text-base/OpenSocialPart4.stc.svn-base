*TC 00:00:06;09
Теперь мы немного изменим созданный в прошлый раз гаджет,  

*TC 00:00:09;02
предназначенный для отправки подарков друзьям,  

*TC 00:00:11;17
чтобы реализовать возможность

*TC 00:00:12;27
сохранения и просмотра списка отправленных подарков.

*TC 00:00:15;23
Начнем с изменения 
функции "giveGift", 

*TC 00:00:18;15
чтобы она не только обновляла данные,
но еще и запрашивала возврат данных.

*TC 00:00:22;01
В объекте "dataRequest"
нужно указать, что 

*TC 00:00:24;24
кроме обновления параметра "views"
данных приложения, 

*TC 00:00:27;13
мы также запрашиваем 
сведения о "viewer", 

*TC 00:00:29;28
"viewerFriends" и хранилище 
личных данных "viewer".

*TC 00:00:34;25
Мы внесем похожие изменения 

*TC 00:00:36;27
в функцию 
"loadFriends",

*TC 00:00:38;23
чтобы при загрузке и просмотре 
списка друзей

*TC 00:00:41;14
также запрашивалось личное 
хранилище данных приложения "viewer".

*TC 00:00:46;02
Мы сделаем эти два
запроса параллельными,

*TC 00:00:48;12
чтобы при запуске 
гаджета или отправке подарка 

*TC 00:00:50;26
можно было применить функцию обратного вызова
того же набора информации.

*TC 00:00:54;25
Затем мы меняем функцию 
"onLoadFriends",

*TC 00:00:57;00
чтобы помимо указания 
"viewer" и "viewerFriends"

*TC 00:01:00;27
мы получали "giftData", то есть 
список отправленных подарков.

*TC 00:01:04;04
Мы снова создаем список 
друзей в виде меню с возможностью выбора. 

*TC 00:01:07;05
После вставки
списка на страницу

*TC 00:01:09;24
мы вызываем функцию 
"updateGiftList", 

*TC 00:01:11;27
которая отображает список 
отправленных подарков.

*TC 00:01:14;09
Функция "updateGiftList" извлекает 
информацию из предоставленного нами 

*TC 00:01:18;01
массива данных 

*TC 00:01:19;06
по ID "view" и ключу подарков, 

*TC 00:01:22;13
в котором и хранится
наша информация.

*TC 00:01:24;08
Затем мы берем эти данные и конвертируем 
обратно из формата "json string" 

*TC 00:01:28;10
в объект JavaScript, который мы можем использовать.

*TC 00:01:30;14
Этот объект 
соединяет ID друга 

*TC 00:01:33;15
и ID подарка,

*TC 00:01:34;17
так что мы можем преобразовать 
его в строку, указывающую 

*TC 00:01:37;06
имя друга, которому мы 
отправили подарок, 

*TC 00:01:38;27
и подарок, отправленный другу.

*TC 00:01:41;12
Мы можем вставить этот список в формате HTML на страницу .

*TC 00:01:44;21
Наконец, мы вносим небольшое
изменение в XML-файл гаджета, 

*TC 00:01:47;27
чтобы создать место, на которое
можно вставить HTML.

*TC 00:01:52;03
Вот новая версия нашего гаджета, 
которая отображает 

*TC 00:01:54;07
список отправленных подарков

*TC 00:01:55;27
таким образом, что при 
нажатии кнопки отправки подарка
 
*TC 00:01:58;00
он появляется 
в списке ниже.

*TC 00:02:00;11
Подробнее об этой теме 

*TC 00:02:02;02
и о социальных API

*TC 00:02:04;06
можно узнать в руководстве на сайте code.google.com 

*TC 00:02:06;20
в разделе, посвященном OpenSocial. 





